# Как добавить кастомный блок в программу?

## 1. Создание кастомного блока

### 1.1. Откройте файл кастомных блоков
Все кастомные блоки определяются в файле:
```
rudironIDE/src/components/Blocks/CustomBlocks.jsx
```

### 1.2. Определите новый блок
Добавьте определение блока с помощью API Blockly:
```javascript
Blockly.Blocks['my_custom_block'] = {
  init: function() {
    this.appendDummyInput()
      .appendField('Мой кастомный блок');
    this.setOutput(true, 'Number');
    this.setColour(230);
    this.setTooltip('Описание блока');
    this.setHelpUrl('');
  }
};
```

#### Основные параметры блока:

| Метод/свойство         | Описание                                                                 |
|-----------------------|--------------------------------------------------------------------------|
| appendDummyInput()    | Добавляет простое текстовое поле                                          |
| appendValueInput(name)| Добавляет поле для значения (можно указать тип через setCheck)            |
| appendStatementInput(name)| Добавляет поле для вложенных блоков                                 |
| setOutput(type)       | Делает блок возвращающим значение (например, 'Number')                    |
| setPreviousStatement(type)| Позволяет присоединять блок к предыдущему                         |
| setNextStatement(type)| Позволяет присоединять блок к следующему                                 |
| setColour(value)      | Цвет блока (число или строка)                                             |
| setTooltip(text)      | Подсказка при наведении                                                   |
| appendField(field, name)| Добавляет поле (например, кнопку, текст, переменную)                 |
| setOnChange(handler)  | Устанавливает обработчик изменений                                        |
| setMutator(mutator)   | Добавляет мутатор (для динамических блоков)                              |


### 1.3. (Опционально) Добавьте кастомные поля, кнопки, переменные
Можно использовать кастомное поле FieldButton из папки Blocks:
```javascript
this.appendDummyInput()
  .appendField(new Blockly.FieldButton('Кнопка', null, {
    onClick: () => alert('Кнопка нажата!')
  }), 'BUTTON');
```

---

## 2. Добавление блока в toolbox (панель категорий)

### 2.1. Откройте файл категорий:
```
rudironIDE/src/components/BlockPanel/CategoriesToolbox.jsx
```

### 2.2. Найдите нужную категорию или создайте новую

### 2.3. Добавьте XML для блока в toolboxXML:
```xml
<block type="my_custom_block"></block>
```
Пример:
```javascript
{
  id: 'custom',
  name: 'Кастомные',
  image: '/categories/custom-icon.png',
  toolboxXML: `
    <xml>
      <category name="Кастомные" colour="#FFAA00">
        <block type="my_custom_block"></block>
      </category>
    </xml>
  `
}
```

## 4. Проверка блока в интерфейсе
- Перезапустите приложение
- Откройте нужную категорию в панели блоков
- Найдите и перетащите новый блок на рабочую область
- Проверьте механики блока - его взаимодействие с другими блоками(соединение, вложенность, принимаемые параметры)

---

## 5. Пример полного цикла

1. **Создайте блок в CustomBlocks.jsx**
2. **Добавьте XML в toolbox категории**
3. **Перезапустите приложение**
4. **Проверьте блок в интерфейсе**

## 6. Советы
- Используйте уникальные имена для типа блока (`type`)
- Для сложных блоков используйте несколько входов/выходов
- Для динамических блоков используйте мутаторы
- Для интеграции с переменными используйте стандартные поля Blockly
- Для кнопок используйте FieldButton
---