# FieldButton

## Назначение
`FieldButton.js` реализует кастомное поле для Blockly, которое отображается как интерактивная кнопка внутри блока. Это расширение стандартного поля Blockly, позволяющее добавлять в блоки кнопки с кастомным поведением.

## Основные элементы

### Класс: `FieldButton`

#### Конструктор
```js
constructor(text, validator = null, config = {})
```
- **text** (`string`) — текст, который будет отображаться на кнопке.
- **validator** (`function`, опционально) — функция-валидатор, вызывается при изменении значения поля.
- **config** (`object`, опционально) — объект с дополнительными настройками:
  - `onClick` (`function`) — обработчик клика по кнопке.
  - `className` (`string`) — CSS-класс для стилизации кнопки.
  - `disabled` (`boolean`) — если true, кнопка неактивна.

#### Пример использования конструктора:
```jsx
<FieldButton text="Запустить" validator={null} config={{ onClick: () => alert('Кнопка нажата!'), className: 'my-button', disabled: false }} />
```

---

### Основные методы

#### `initView()`
- **Назначение:**  
  Создает DOM-элемент кнопки, добавляет его в SVG-структуру блока, навешивает обработчик событий.
- **Что делает:**  
  - Создает SVG-элемент `<foreignObject>`, внутри которого размещается HTML-кнопка.
  - Применяет стили и классы.
  - Навешивает обработчик клика, если он задан в `config`.

#### `setValue(newValue)`
- **Назначение:**  
  Устанавливает новое значение для поля (текст кнопки).
- **Параметры:**  
  - `newValue` (`string`) — новый текст кнопки.
- **Что делает:**  
  - Обновляет отображаемый текст на кнопке.
  - Вызывает валидатор, если он задан.

#### `getValue()`
- **Назначение:**  
  Возвращает текущее значение поля (текст кнопки).
- **Возвращает:**  
  - `string` — текущий текст кнопки.

#### `setEnabled(enabled)`
- **Назначение:**  
  Включает или отключает кнопку.
- **Параметры:**  
  - `enabled` (`boolean`) — если false, кнопка становится неактивной.

#### `dispose()`
- **Назначение:**  
  Очищает ресурсы, удаляет обработчики событий и DOM-элементы, связанные с полем.

---

## Пример использования в блоке
```jsx
<Blockly.Blocks['block_with_button'] = {
  init: function() {
    this.appendDummyInput()
      .appendField(new FieldButton('Кликни меня', null, {
        onClick: () => alert('Кнопка нажата!')
      }), 'BUTTON');
    this.setColour(160);
  }
};
```

## Интеграция с Blockly

- Поле регистрируется через `Blockly.fieldRegistry.register('field_button', FieldButton);`
- Используется в блоках через `appendField(new FieldButton(...))`
- Поддерживает сериализацию/десериализацию Blockly

