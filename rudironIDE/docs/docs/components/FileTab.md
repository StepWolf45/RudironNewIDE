# FileTab

## Назначение
FileTab отвечает за отображение и управление вкладками файлов в приложении. Позволяет пользователям переключаться между открытыми файлами, создавать новые файлы и закрывать существующие. Каждая вкладка содержит свой собственный Blockly workspace.

## Основные переменные состояния

| Переменная      | Тип      | Описание                                                        |
|-----------------|----------|-----------------------------------------------------------------|
| tabTitles       | object   | Объект с заголовками вкладок `{fileId: title}`                  |

## Контексты (useContext)
- `FileContext` — используется для управления файлами, вкладками и workspace'ами

## Хуки
- `useState` — для управления заголовками вкладок
- `useMemo` — для мемоизации workspaceStates
- `useEffect` — для обработки событий Electron и обновления заголовков
- `useContext` — для доступа к FileContext

## Методы управления

| Метод        | Аргументы         | Возвращаемое значение | Описание                                                        |
|--------------|-------------------|----------------------|-----------------------------------------------------------------|
| handleClose  | id (number)       | void                 | Закрывает файл через Electron API и FileContext                |

## Props
Компонент не принимает props напрямую, но использует контекст.

## Используемые компоненты
- `Tabs` из Ant Design — контейнер вкладок
- `TabPane` из Ant Design — отдельная вкладка
- `BlocklyWorkspace` — рабочая область Blockly для каждого файла

## Структура компонента
```jsx
<div className="file-panel">
  <Tabs>
    {files.map((file) => (
      <TabPane key={file.id}>
        <BlocklyWorkspace
          initialXml={workspaceStates[file.id]}
          onWorkspaceMount={(workspace) => handleWorkspaceMount(file.id, workspace)}
        />
      </TabPane>
    ))}
  </Tabs>
</div>
```

## События Electron
Компонент обрабатывает следующие события Electron:
- `file-saved` — обновляет заголовок вкладки при сохранении файла
- `close-file` — отправляет событие закрытия файла в основной процесс

## Интеграция с FileContext

### Получаемые данные:
- `files` — массив всех открытых файлов
- `activeFileId` — ID активного файла
- `workspaceStates` — состояния workspace'ов
- `handleCreateNewFile` — функция создания нового файла
- `handleCloseFile` — функция закрытия файла
- `handleTabChange` — функция переключения вкладок
- `handleWorkspaceMount` — функция регистрации workspace

### Отправляемые данные:
- `setActiveFileId` — установка активного файла
- `setCurrentFilePath` — обновление текущего пути файла

## Пример использования
```javascript
import FileTab from '../FileTab/FileTab';

// В родительском компоненте
<FileTab />
```

## Особенности
- Поддерживает редактируемые вкладки (editable-card)
- Автоматически создает вкладку "add" для создания новых файлов
- Каждая вкладка содержит отдельный Blockly workspace
- Интегрируется с Electron для управления файлами
- Поддерживает закрытие вкладок через кнопку X
- Автоматически обновляет заголовки при сохранении файлов
- Использует мемоизацию для оптимизации производительности

## Стилизация
Компонент использует следующие CSS классы:
- `.file-panel` — основной контейнер
- `.tab-content` — содержимое вкладки
- `.tab-label` — заголовок вкладки
- Кастомные стили для темной темы

## Состояния вкладок
- **Активная вкладка** — выделяется цветом и стилем
- **Неактивные вкладки** — стандартный вид
- **Вкладка "add"** — специальная вкладка для создания новых файлов
- **Закрываемые вкладки** — показывают кнопку X (кроме последней)

## Обработка ошибок
- Проверяет наличие Electron API перед использованием
- Выводит предупреждения в консоль при отсутствии API
- Graceful fallback при ошибках загрузки файлов 